<!DOCTYPE html><html lang="vi" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="FPTU SecAthon 2020 Web Writeup IAW301 &amp; IAW302" /><meta name="author" content="Hades" /><meta property="og:locale" content="vi" /><meta name="description" content="IAW301" /><meta property="og:description" content="IAW301" /><link rel="canonical" href="https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/" /><meta property="og:url" content="https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/" /><meta property="og:site_name" content="Ethical Hackers Club" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-20T23:36:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FPTU SecAthon 2020 Web Writeup IAW301 &amp; IAW302" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Hades" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2020-10-20T23:36:00+07:00","datePublished":"2020-10-20T23:36:00+07:00","description":"IAW301","mainEntityOfPage":{"@type":"WebPage","@id":"https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/"},"url":"https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/","@type":"BlogPosting","author":{"@type":"Person","name":"Hades"},"headline":"FPTU SecAthon 2020 Web Writeup IAW301 &amp; IAW302","@context":"https://schema.org"}</script><title>FPTU SecAthon 2020 | Web Writeup | IAW301 & IAW302 | Ethical Hackers Club</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ethical Hackers Club"><meta name="application-name" content="Ethical Hackers Club"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.updateMermaid(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ethical Hackers Club</a></div><div class="site-subtitle font-italic">FPT University</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a id="mode-toggle-wrapper" tabindex="0" onclick="flipMode()"> <i class="mode-toggle fas fa-adjust"></i> </a> <span class="icon-border"></span> <a href="https://github.com/FPTU-Ethical-Hackers-Club" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://facebook.com/ehc.fptu" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ehc.fpt','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>FPTU SecAthon 2020 | Web Writeup | IAW301 & IAW302</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>FPTU SecAthon 2020 | Web Writeup | IAW301 & IAW302</h1><div class="post-meta text-muted"><div> By <em> <a href="https://discordapp.com/users/553165994298966049">Hades</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2020-10-20 23:36:00 +0700" data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 20, 2020, 11:36 PM +0700" >Oct 20, 2020</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="484 words"> <em>2 min</em> read</span></div></div></div><div class="post-content"><h1 id="iaw301">IAW301</h1><p><img data-proofer-ignore data-src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F0e6aa074-6354-4241-a129-549aa7c121d4%2FUntitled.png?table=block&amp;id=03c965bf-709c-4320-9390-69f239b0542e&amp;width=3840&amp;userId=c5215cbc-c2f5-493c-96f9-c58e536dabe6&amp;cache=v2" alt="0" /></p><ul><li><p>HINT 2 : http://35.198.195.87:7001/src.zip</p><li><p>HINT 4 : “valid/email*“@gmail.com</p></ul><h2 id="solution">SOLUTION<a href="#solution"><i class="fas fa-hashtag"></i></a></h2></h2><p>Dựa vào hint 2 ta đọc source và biết ngay vuln tại phần email trong chức năng registration.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$regexEmail</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"options"</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s2">"regexp"</span><span class="o">=&gt;</span><span class="s2">"/^(?!(?:(?:</span><span class="se">\\\\</span><span class="s2">x22?</span><span class="se">\\\\</span><span class="s2">x5C[</span><span class="se">\\\\</span><span class="s2">x00-</span><span class="se">\\\\</span><span class="s2">x7E]</span><span class="se">\\\\</span><span class="s2">x22?)|(?:</span><span class="se">\\\\</span><span class="s2">x22?[^</span><span class="se">\\\\</span><span class="s2">x5C</span><span class="se">\\\\</span><span class="s2">x22]</span><span class="se">\\\\</span><span class="s2">x22?))</span><span class="si">{</span><span class="nv">255,})(?!(?:(?:\\\\x22?\\\\x5C[\\\\x00-\\\\x7E]\\\\x22?)|(?:\\\\x22?[^\\\\x5C\\\\x22]\\\\x22?)){240,}@)(?:(?:[\\\\x21\\\\x23-\\\\x27\\\\x2A\\\\x2B\\\\x2D\\\\x2F-\\\\x39\\\\x3D\\\\x3F\\\\x5E-\\\\x7E]+)|(?:\\\\x22(?:[\\\\x01-\\\\x08\\\\x0B\\\\x0C\\\\x0E-\\\\x1F\\\\x21\\\\x23-\\\\x5B\\\\x5D-\\\\x7F]|(?:\\\\x5C[\\\\x00-\\\\x7F]))*\\\\x22))(?:\\\\.(?:(?:[\\\\x21\\\\x23-\\\\x27\\\\x2A\\\\x2B\\\\x2D\\\\x2F-\\\\x39\\\\x3D\\\\x3F\\\\x5E-\\\\x7E]+)|(?:\\\\x22(?:[\\\\x01-\\\\x08\\\\x0B\\\\x0C\\\\x0E-\\\\x1F\\\\x21\\\\x23-\\\\x5B\\\\x5D-\\\\x7F]|(?:\\\\x5C[\\\\x00-\\\\x7F]))*\\\\x22)))*@(?:(?:(?!.*[^.]{64,})(?:(?:(?:xn--)?[a-z0-9]+(?:-+[a-z0-9]+)*\\\\.){1,126}){1,}(?:(?:[a-z][a-z0-9]*)|(?:(?:xn--)[a-z0-9]+))(?:-+[a-z0-9]+)*)|(?:\\\\[(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){7})|(?:(?!(?:.*[a-f0-9][:\\\\]]){7,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,5})?)))|(?:(?:IPv6:(?:(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){5}:)|(?:(?!(?:.*[a-f0-9]:){5,})(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3})?::(?:[a-f0-9]{1,4}(?::[a-f0-9]{1,4}){0,3}:)?)))?(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))(?:\\\\.(?:(?:25[0-5])|(?:2[0-4][0-9])|(?:1[0-9]{2})|(?:[1-9]?[0-9]))){3</span><span class="si">}</span><span class="s2">))</span><span class="se">\\\\</span><span class="s2">]))$/iD"</span><span class="p">,</span><span class="s2">"default"</span><span class="o">=&gt;</span><span class="kc">false</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">filter_var</span><span class="p">(</span><span class="nv">$username</span><span class="p">,</span> <span class="no">FILTER_VALIDATE_REGEXP</span><span class="p">,</span> <span class="nv">$regexUsername</span><span class="p">)){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">filter_var</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="no">FILTER_VALIDATE_REGEXP</span><span class="p">,</span> <span class="nv">$regexEmail</span><span class="p">)){</span>
<span class="mf">.............</span>
<span class="p">}}</span>
</pre></table></code></div></div><p>Và dưới đây là câu query signup bị vuln:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$sql</span> <span class="o">=</span> <span class="s1">'INSERT INTO Users (username, email, password) VALUES ("'</span><span class="mf">.</span><span class="nv">$username</span><span class="mf">.</span><span class="s1">'", "'</span><span class="mf">.</span><span class="nv">$email</span><span class="mf">.</span><span class="s1">'", "'</span><span class="mf">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span><span class="mf">.</span><span class="s1">'")'</span><span class="p">;</span> 
</pre></table></code></div></div><p>Để inject và lấy dữ liệu trong database được, chúng ta cần bypass cái regex ở trên, bằng <a href="https://www.programmersought.com/article/88334149880/">một số kĩ thuật fuzzing và document</a></p><h2 id="payload">PAYLOAD<a href="#payload"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>#payload bind-sqli username=a&amp;password=b&amp;email="||(ascii(substr((select 'aa'),1,1))&gt;53)||"@aaaaaagmail.com
</pre></table></code></div></div><p>⇒ Flag: <code class="language-plaintext highlighter-rouge">FUSEC{Fuzzing_Email_For_SQLi}</code></p><h1 id="iaw302">IAW302</h1><p><img data-proofer-ignore data-src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc29d742d-dd15-4287-9e10-296d6fbddc8b%2FUntitled.png?table=block&amp;id=20aa13e3-b99a-4910-9569-bb4bffe7bec0&amp;width=3840&amp;userId=c5215cbc-c2f5-493c-96f9-c58e536dabe6&amp;cache=v2" alt="1" /></p><p>Source code:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
    <span class="nb">session_start</span><span class="p">();</span>
    <span class="o">@</span><span class="k">include</span> <span class="s1">'/flag.php'</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'choose'</span><span class="p">])){</span>
        <span class="nb">highlight_file</span><span class="p">(</span><span class="s2">"result.php"</span><span class="p">);</span>
        <span class="k">die</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nv">$name</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s2">"ms"</span><span class="p">)</span><span class="mf">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'choose'</span><span class="p">])</span><span class="mf">.</span><span class="o">@</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'PHPSESSID'</span><span class="p">]);</span>
    <span class="nb">session_destroy</span><span class="p">();</span>
    <span class="nv">$log_file</span> <span class="o">=</span> <span class="s2">"./"</span><span class="mf">.</span><span class="nv">$name</span><span class="mf">.</span><span class="s2">".txt"</span><span class="p">;</span>
    <span class="k">echo</span> <span class="s2">"Log: </span><span class="nv">$log_file</span><span class="s2">&lt;/br&gt;"</span><span class="p">;</span>

    <span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$log_file</span><span class="p">,</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'choose'</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="nv">$log_file</span><span class="p">)){</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">"Loser"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="o">@</span><span class="nv">$flag</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><h2 id="solution-1">SOLUTION<a href="#solution-1"><i class="fas fa-hashtag"></i></a></h2></h2><p>Sau khi test sơ qua mình đã thấy được code mà author cung cấp ở <code class="language-plaintext highlighter-rouge">http://35.198.195.87:7002/result.php</code>. Đây cũng là 1 dạng được khá nhiều người biết đến, dùng kĩ thuật race condition để khai thác. Và bây giờ mình sẽ phân tích, tại sao lại có thể exploit bằng race-con.</p><ul><li><p>Đầu tiên giá trị của <code class="language-plaintext highlighter-rouge">$name</code> được gán bằng md5-encode của <code class="language-plaintext highlighter-rouge">date</code>, <code class="language-plaintext highlighter-rouge">get parameter</code> và <code class="language-plaintext highlighter-rouge">session</code>, tiếp theo đó <code class="language-plaintext highlighter-rouge">$name</code> được lấy làm tên file txt và được nạp nội dung vào, sau đó kiểm tra xóa file thông qua đoạn <code class="language-plaintext highlighter-rouge">if(@unlink($log_file))</code>, nếu false thì <code class="language-plaintext highlighter-rouge">echo</code> flag, và ngược lại thì <code class="language-plaintext highlighter-rouge">die("Loser")</code>.</p><li><p>Nhìn thì có vẻ như không có bất kì vuln nào, nhưng các bạn hãy chú ý vào đoạn <code class="language-plaintext highlighter-rouge">session_destroy()</code>; được đặt giữa source code và nó có chức năng hủy <code class="language-plaintext highlighter-rouge">session</code>. Điều này rất nguy hiểm, vì nếu <code class="language-plaintext highlighter-rouge">session</code> bị hủy giữa chừng và đồng thời có nhiều request được gửi tới thì sẽ gây ra tình trạng mất dữ liệu bất ngờ, trong trường hợp trên thì sẽ mất dữ liệu của <code class="language-plaintext highlighter-rouge">$name</code></p></ul><p>Do đó để <code class="language-plaintext highlighter-rouge">unlink</code> trả về <code class="language-plaintext highlighter-rouge">false</code> thì chỉ cần làm cho <code class="language-plaintext highlighter-rouge">$name</code> bị mất dữ liệu thì sẽ không tồn tại tên file , bằng cách dùng race condition để tạo ra nhiều request đồng thời:</p><blockquote><p><em>“Warning Immediate session deletion may cause unwanted results. When there is concurrent requests, other connections may see sudden session data loss. e.g. Requests from JavaScript and/or requests from URL links. Although current session module does not accept empty session ID cookie, but immediate session deletion may result in empty session ID cookie due to client(browser) side race condition. This will result that the client creates many session ID needlessly. To avoid these, you must set deletion time-stamp to $_SESSION and reject access while later. Or make sure your application does not have concurrent requests. This applies to session_regenerate_id() also.”</em> - From <a href="https://www.php.net/manual/en/function.session-destroy.php">PHP Main Page</a></p></blockquote><h2 id="payload-1">PAYLOAD<a href="#payload-1"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Chỉ cần dùng thread để spam là okie !</p></blockquote><p>⇒ Flag: <code class="language-plaintext highlighter-rouge">FUSEC{Hua_voi_moi_nguoi_lan_nay_lan_cuoi_dao_de}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/web-challenges/'>Web Challenges</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/fusec20/" class="post-tag no-text-decoration" >fusec20</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=FPTU SecAthon 2020 | Web Writeup | IAW301 & IAW302 - Ethical Hackers Club&url=https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=FPTU SecAthon 2020 | Web Writeup | IAW301 & IAW302 - Ethical Hackers Club&u=https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=FPTU SecAthon 2020 | Web Writeup | IAW301 & IAW302 - Ethical Hackers Club&url=https://fptu-ethical-hackers-club.github.io/posts/FuSec3-IAW301-IAW302/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h4>Recent Update</h4><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SVATTT-Crypto/">ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups</a><li><a href="/posts/SVATTT-Web/">ASCIS (ASEAN Student Contest on Information Security) 's Web Write-ups</a><li><a href="/posts/FuSec3-Forensics/">FPTU SecAthon 2020 | Forensics Writeup | FRS301</a><li><a href="/posts/ACSC2021-Forensics/">Asian Cyber Security Challenge 2021 | Forensics Writeup | Nyong Coin, BitLocker Artifact</a><li><a href="/posts/FuSec4-CRY302-CRY303/">FPTU SecAthon 2021 | Cryptographic Writeup | CRY302 & CRY303</a></ul></div><div id="access-tags"><h4 class="text-muted">Trending Tags</h4><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/wiki/">wiki</a> <a class="post-tag" href="/tags/fusec21/">fusec21</a> <a class="post-tag" href="/tags/cryptographic/">cryptographic</a> <a class="post-tag" href="/tags/fusec20/">fusec20</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/acsc21/">acsc21</a> <a class="post-tag" href="/tags/svattt2021/">SVATTT2021</a> <a class="post-tag" href="/tags/binary/">binary</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h4 class="pl-3 pt-2 mb-2">Contents</h4><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FuSec4-PRP201/"><div class="card-body"> <em class="timeago small" date="2021-10-10 23:30:00 +0700" >Oct 10</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Web Writeup | PRP201</h3><div class="text-muted small"><p> PRP201 Đây là challenge mà mình đã đoán được một phần, nhưng vẫn mất gần 1 ngày để giải ra :&amp;lt; Một sản phẩm đến từ anh Khoa (matuhn) Truy cập vào bài thì thấy có 5 đường dẫn đến 5 f...</p></div></div></a></div><div class="card"> <a href="/posts/FuSec4-PRP202/"><div class="card-body"> <em class="timeago small" date="2021-10-13 12:30:00 +0700" >Oct 13</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Web Writeup | PRP202</h3><div class="text-muted small"><p> PRP202 Một bài hay và cực khó với mình, chả trách người anh T giấu tên cứ bảo làm thử 2 ngày để làm, nhiều lần thất bại, nhưng kết quả thật xứng đáng Source code and analysis Source code Bắt...</p></div></div></a></div><div class="card"> <a href="/posts/SVATTT-Web/"><div class="card-body"> <em class="timeago small" date="2021-10-17 12:00:00 +0700" >Oct 17</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ASCIS (ASEAN Student Contest on Information Security) 's Web Write-ups</h3><div class="text-muted small"><p> Ở SVATTT 2021 năm nay thì team mình không vượt qua vòng lại, tuy nhiên cá nhân mình vẫn solve đc 2 bài web Script Kiddie và OProxy, coi như là một kỉ niệm lần đầu đi thi SVATTT có vui lẫn buồn. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Code-Battle-2019/" class="btn btn-outline-primary" prompt="Older"><p>Code Battle 2019</p></a> <a href="/posts/FuSec3-CRY301-CRY302/" class="btn btn-outline-primary" prompt="Newer"><p>FPTU SecAthon 2020 | Cryptographic Writeup | CRY301 & CRY302</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/FPTU-Ethical-Hackers-Club">FPTU Ethical Hackers' Club</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><h4 class="text-muted">Trending Tags</h4><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/wiki/">wiki</a> <a class="post-tag" href="/tags/fusec21/">fusec21</a> <a class="post-tag" href="/tags/cryptographic/">cryptographic</a> <a class="post-tag" href="/tags/fusec20/">fusec20</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/acsc21/">acsc21</a> <a class="post-tag" href="/tags/svattt2021/">SVATTT2021</a> <a class="post-tag" href="/tags/binary/">binary</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
