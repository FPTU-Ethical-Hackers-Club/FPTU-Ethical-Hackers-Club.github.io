<!DOCTYPE html><html lang="vi" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="ASCIS (ASEAN Student Contest on Information Security) ‘s Cryptography Write-ups" /><meta name="author" content="fairytypean" /><meta property="og:locale" content="vi" /><meta name="description" content="EasyOne" /><meta property="og:description" content="EasyOne" /><link rel="canonical" href="https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/" /><meta property="og:url" content="https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/" /><meta property="og:site_name" content="Ethical Hackers Club" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-16T22:00:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ASCIS (ASEAN Student Contest on Information Security) ‘s Cryptography Write-ups" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@fairytypean" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2021-12-29T11:33:52+07:00","datePublished":"2021-10-16T22:00:00+07:00","description":"EasyOne","mainEntityOfPage":{"@type":"WebPage","@id":"https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/"},"url":"https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/","@type":"BlogPosting","author":{"@type":"Person","name":"fairytypean"},"headline":"ASCIS (ASEAN Student Contest on Information Security) ‘s Cryptography Write-ups","@context":"https://schema.org"}</script><title>ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups | Ethical Hackers Club</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ethical Hackers Club"><meta name="application-name" content="Ethical Hackers Club"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.updateMermaid(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ethical Hackers Club</a></div><div class="site-subtitle font-italic">FPT University</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a id="mode-toggle-wrapper" tabindex="0" onclick="flipMode()"> <i class="mode-toggle fas fa-adjust"></i> </a> <span class="icon-border"></span> <a href="https://github.com/FPTU-Ethical-Hackers-Club" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://facebook.com/ehc.fptu" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ehc.fpt','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/thangpd3160">fairytypean</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-10-16 22:00:00 +0700" data-toggle="tooltip" data-placement="bottom" title="Sat, Oct 16, 2021, 10:00 PM +0700" >Oct 16</em> </span> <span> Updated <em class="timeago" date="2021-12-29 11:33:52 +0700 " data-toggle="tooltip" data-placement="bottom" title="Wed, Dec 29, 2021, 11:33 AM +0700" >Dec 29</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2321 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="easyone">EasyOne</h1><blockquote><p>A challenge about digital certificate problem, just the basic things. Full source code can found at <a href="https://github.com/FPTU-Ethical-Hackers-Club/SVATTT/tree/main/2021/crypto/EasyOne/source">here</a>.</p></blockquote><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138579352-157d38db-e464-432d-a527-f46f64650f46.png" alt="image" /></p><h3 id="1-challenge-analysis">1. Challenge analysis<a href="#1-challenge-analysis"><i class="fas fa-hashtag"></i></a></h3></h3><p>Read the source code, I figured out that there is a route <code class="language-plaintext highlighter-rouge">/flag</code> which will tell us the flag of this challenge, but only admin can access content of flag:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/flag"</span><span class="p">)</span>
<span class="o">@</span><span class="n">login_required</span>
<span class="k">def</span> <span class="nf">flag</span><span class="p">():</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s">"You are not admin"</span>
    <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="s">"role"</span><span class="p">]</span> <span class="o">==</span> <span class="n">ROLE_ADMIN</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s">"ASCIS{xxxxxx}"</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'flag.html'</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p>There is a register function, but we can’t register as admin. It just allow us to register as a normal user:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>@app.route("/register", methods=('GET', 'POST'))
def register():
    if request.method == 'POST':
        username = request.form['username']
        password = request.form['password']
        email = request.form['email']
        role = ROLE_USER

        if not username or not password:
            flash('Username and Password is required!')
        else:
            do_register(username, password, email, role)

            return redirect(url_for('login'))

    return render_template('register.html')
</pre></table></code></div></div><p>However, examine carefully the source code, I found that there is another way to login without admin account. It’s the <code class="language-plaintext highlighter-rouge">/logincert</code> route:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="c1"># This function only for admin
</span><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/logincert"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">(</span><span class="s">'GET'</span><span class="p">,</span> <span class="s">'POST'</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">logincert</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
        <span class="n">username</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="s">'file'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">uploaded_file</span><span class="p">.</span><span class="n">filename</span> <span class="o">!=</span> <span class="s">''</span><span class="p">:</span>
            <span class="n">split_tup</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">uploaded_file</span><span class="p">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">split_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">".pem"</span><span class="p">:</span>
                <span class="n">flash</span><span class="p">(</span><span class="s">'Cert file is invalid'</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'logincert.html'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>    
                <span class="n">username</span> <span class="o">=</span> <span class="n">validate_certificate</span><span class="p">(</span><span class="n">uploaded_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">username</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">flash</span><span class="p">(</span><span class="s">'Login cert is invalid!'</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'logincert.html'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>    
            <span class="n">session</span><span class="p">[</span><span class="s">"username"</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
            <span class="n">session</span><span class="p">[</span><span class="s">"role"</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROLE_ADMIN</span>

            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">'index'</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'logincert.html'</span><span class="p">)</span>
</pre></table></code></div></div><p>Notice the line code <code class="language-plaintext highlighter-rouge">username = validate_certificate(uploaded_file)</code>. Follow the code, it leads us to <code class="language-plaintext highlighter-rouge">verify_certificate_chain(cert_pem, trusted_certs)</code> function in file <a href="https://github.com/thangpd3160/ASCIS_2021/blob/main/EasyOne/certutils.py">certutils.py</a>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre> <span class="k">def</span> <span class="nf">verify_certificate_chain</span><span class="p">(</span><span class="n">cert_pem</span><span class="p">,</span> <span class="n">trusted_certs</span><span class="p">):</span>
    <span class="n">certificate</span> <span class="o">=</span> <span class="n">crypto</span><span class="p">.</span><span class="n">load_certificate</span><span class="p">(</span><span class="n">crypto</span><span class="p">.</span><span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="n">cert_pem</span><span class="p">)</span>
    <span class="c1"># parse ceritificate information
</span>    <span class="n">clientcert</span> <span class="o">=</span> <span class="n">CertInfo</span><span class="p">(</span><span class="n">certificate</span><span class="p">)</span>
    <span class="c1"># get subject common name
</span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">clientcert</span><span class="p">.</span><span class="n">subject_cn</span>
    <span class="n">issuer</span> <span class="o">=</span> <span class="n">clientcert</span><span class="p">.</span><span class="n">issuer_cn</span>
    <span class="c1"># Check if subject is admin user
</span>    <span class="k">if</span> <span class="n">subject</span> <span class="o">!=</span> <span class="s">"admin"</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"Not trusted user"</span><span class="p">)</span>
    <span class="c1"># validate issuer 
</span>    <span class="k">if</span> <span class="n">issuer</span> <span class="o">!=</span> <span class="s">"ca"</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"Not trusted ca"</span><span class="p">)</span>
    <span class="n">thumbprint</span> <span class="o">=</span> <span class="n">clientcert</span><span class="p">.</span><span class="n">digest_sha256</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
    <span class="c1">#TODO: validate thumbprint
</span>    <span class="c1">#Create a certificate store and add your trusted certs
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">crypto</span><span class="p">.</span><span class="n">X509Store</span><span class="p">()</span>
        <span class="c1"># Assuming the certificates are in PEM format in a trusted_certs list
</span>        <span class="k">for</span> <span class="n">_cert</span> <span class="ow">in</span> <span class="n">trusted_certs</span><span class="p">:</span>
            <span class="n">cert_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">_cert</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
            <span class="n">cert_data</span> <span class="o">=</span> <span class="n">cert_file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">client_certificate</span> <span class="o">=</span> <span class="n">crypto</span><span class="p">.</span><span class="n">load_certificate</span><span class="p">(</span><span class="n">crypto</span><span class="p">.</span><span class="n">FILETYPE_PEM</span><span class="p">,</span> <span class="n">cert_data</span><span class="p">)</span>
            <span class="n">store</span><span class="p">.</span><span class="n">add_cert</span><span class="p">(</span><span class="n">client_certificate</span><span class="p">)</span>
        <span class="c1"># Create a certificate context using the store 
</span>        <span class="n">store_ctx</span> <span class="o">=</span> <span class="n">crypto</span><span class="p">.</span><span class="n">X509StoreContext</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">certificate</span><span class="p">)</span>
        <span class="c1"># Verify the certificate signature, returns None if it can validate the certificate
</span>        <span class="n">store_ctx</span><span class="p">.</span><span class="n">verify_certificate</span><span class="p">()</span>
        <span class="c1"># verify success
</span>        <span class="k">return</span> <span class="n">subject</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[+] Debug certificate validation failed"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
</pre></table></code></div></div><p>For the one that does not really understand the detail code of digital certificate as me, I have been overwhelmed and confused a little bit. However, just pay attention to the output and the requirement in 2 <code class="language-plaintext highlighter-rouge">if</code> statements, I can draw out the 2 following conclusions:</p><ul><li>There are 2 requirements to successfully login by certificate: the subject must be <code class="language-plaintext highlighter-rouge">admin</code> and the issuers must be <code class="language-plaintext highlighter-rouge">ca</code>. It’s really easy~~<li>After passing these 2 requirements, it return us <code class="language-plaintext highlighter-rouge">subject</code>, which is actually the admin. Now we will a <code class="language-plaintext highlighter-rouge">admin</code> session, thus get the flag. So, let’s go on to create a digital ceritificate.</ul><h3 id="2-create-digital-certificate">2. Create digital certificate<a href="#2-create-digital-certificate"><i class="fas fa-hashtag"></i></a></h3></h3><p>I use <strong>openssl</strong> on Kali Linux machine to create digital certiifcate. The ideas is simple:</p><ul><li>Create a certificate owned by <code class="language-plaintext highlighter-rouge">ca</code> \rightarrow→ <strong>subject = ca</strong> and <strong>issuer = ca</strong>.<li>Create another certificate owned by <code class="language-plaintext highlighter-rouge">admin</code> \rightarrow→ <strong>subject = admin</strong> and <strong>issuer = admin</strong>.<li>Sign the second certificate by the first certificate \rightarrow→ <strong>subject = admin</strong> and <strong>issuer = ca</strong>.</ul><p>For the technical details, follow step by step as following:</p><ul><li>Create a RSA key pair for <code class="language-plaintext highlighter-rouge">ca</code> certificate:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>thangpdhe141354@kali:~$ openssl genrsa -out ca.key 2048
Generating RSA private key, 2048 bit long modulus (2 primes)
.............+++++
...........................+++++
e is 65537 (0x010001)
</pre></table></code></div></div><ul><li>Create a certificate owned by <code class="language-plaintext highlighter-rouge">ca</code>. Left all other blanks and fill <code class="language-plaintext highlighter-rouge">Common Name</code> as <code class="language-plaintext highlighter-rouge">ca</code>:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ openssl req -new -x509 -days 1826 -key ca.key -out ca.crt
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:ca
Email Address []:
</pre></table></code></div></div><p>After create, you can see the CA look like this:</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138579930-7bd4845f-9f97-4618-9b32-0e60b9649710.png" alt="image" /></p><ul><li>Create a RSA key pair for admin certificate:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$openssl genrsa -out ia.key 2048
Generating RSA private key, 2048 bit long modulus (2 primes)
.....+++++
.............+++++
e is 65537 (0x010001)
</pre></table></code></div></div><ul><li>Create a certificate owned by <code class="language-plaintext highlighter-rouge">admin</code>. Left all other blanks and fill <code class="language-plaintext highlighter-rouge">Common Name</code> as <code class="language-plaintext highlighter-rouge">admin</code>:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ openssl req -new -key ia.key -out ia.csr
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:
State or Province Name (full name) [Some-State]:
Locality Name (eg, city) []:
Organization Name (eg, company) [Internet Widgits Pty Ltd]:
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:admin
Email Address []:

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
</pre></table></code></div></div><p>The created certificate will look as following:</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580005-6c165763-ab39-4370-b9af-b0b89fc7dac4.png" alt="image" /></p><ul><li>Sign the second certificate by the first certificate:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ openssl x509 -req -days 730 -in ia.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out ia.crt
Signature ok
subject=C = AU, ST = Some-State, O = Internet Widgits Pty Ltd, CN = admin
Getting CA Private Key
</pre></table></code></div></div><p>The signed certificate will look as following:</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580048-029a51e4-7400-4524-972a-307567318389.png" alt="image" /></p><ul><li>Finally, convert the certificate to .pem format to fit the code requirement:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ openssl x509 -in ia.crt -out ia.pem -outform PEM
</pre></table></code></div></div><h3 id="3-submit-the-digital-certificate-and-get-the-flag">3. Submit the digital certificate and get the flag<a href="#3-submit-the-digital-certificate-and-get-the-flag"><i class="fas fa-hashtag"></i></a></h3></h3><p>Submit file ia.pem to server:</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580152-2c8d5c49-9a00-4b7d-9c16-b74f9f023b6a.png" alt="image" /></p><p>Logon!</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580165-9afd7f4f-707b-4ce8-914e-28c0547c8039.png" alt="image" /></p><p>And get the flag!</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580195-0e67d5bf-47a7-4e4e-9943-58877fc9a7f6.png" alt="image" /></p><h1 id="confuseone">ConfuseOne</h1><blockquote><p>This is blackbox crypto challenge! There is no source, and actually the most practical one.</p></blockquote><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580390-4216d4e3-f078-43f8-bcf1-7e884401a72b.png" alt="image" /></p><h3 id="1-challenge-analysis-1">1. Challenge analysis:<a href="#1-challenge-analysis-1"><i class="fas fa-hashtag"></i></a></h3></h3><p>First at all, just register and login. Browse the web and I see the profile page has a suspected line, which is “You are not admin”:</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580404-e032def2-ad93-488e-b02b-006fa4f2fa1a.png" alt="image" /></p><p>The flag may in this page, but we need to login as admin. It impossible as normal. Now, intercept the request, I see the web use jwt token. Try to decode, I get the following result:</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580417-de0aa608-32c8-4e24-a8a4-a7c72bc6429a.png" alt="image" /></p><p>The point this token is signed by RS256 algorithm. I google the current vulnerability of jwt token and found that there is critical vulnerability related to it, which can change the token by change algorithm from RS256 to HS256. You can learn more the attack at <a href="https://habr.com/en/post/450054/">here</a> as I will not reinvent the wheel 😄</p><p>The last problem which parameter’s value we need to change? As we look from the jwt token, the only parameter that is most susceptible is <code class="language-plaintext highlighter-rouge">username</code>, as the other parameters are either non-determined or trivival for authorization. So, we need to change the value of <code class="language-plaintext highlighter-rouge">username</code> to <code class="language-plaintext highlighter-rouge">admin</code> to get the flag!</p><h3 id="2-attack-and-get-the-flag">2. Attack and get the flag:<a href="#2-attack-and-get-the-flag"><i class="fas fa-hashtag"></i></a></h3></h3><p>I use <a href="https://github.com/cyberblackhole/TokenBreaker">TokenBreaker</a> on github to help me perform this attack. Everything I need is this to pull out the public key of server. It’s easy as we can get it by <strong>openssl</strong>.</p><h5 id="a-get-public-key">a) Get public key:<a href="#a-get-public-key"><i class="fas fa-hashtag"></i></a></h5></h5><p>The technical detail step as following:</p><ul><li>Connect to the server using <strong>openssl</strong> to get the public certificate:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ openssl s_client -connect 139.180.213.39:443
[REDACTED]
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIDETCCAfmgAwIBAgIUaYCW/HwHq1b/axHRKM0BpixnwugwDQYJKoZIhvcNAQEL
BQAwGDEWMBQGA1UEAwwNY3J5cHRvMjAwLmNvbTAeFw0yMTEwMTQwMjM2NDBaFw0y
MjEwMTQwMjM2NDBaMBgxFjAUBgNVBAMMDWNyeXB0bzIwMC5jb20wggEiMA0GCSqG
SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDunk8oVD+9cKXT96aOdl/xZ5RqCpxsStFT
f8l/DW2/m4X5scbhq8Qhco0Mvns75KYtCWAKSvwCzgTSMDcO1/Fzt6xRI4EZPtVS
WE2Mq0VffFCYAzS6q07XWbFZ2tyFqbi/Xudh7tAA6TI098AGHKLjWZDJCA/ZbiQJ
u+7XL1y7TjCWBOEmrcWS7G1Cte1oUhUFfXygmskiTpxX+r3ABJuXT9FZcWu8ZMhl
fMGp/y00sBDCp8xxAcIl/D5lAUzWKyyxW5g46s5WSRHkGpxX/uQUGMwV/WM3/199
uvtVkQri88toQMzd03sWKJJZxuvJpwpw8vi/rbnB4c5/4wfuFjtHAgMBAAGjUzBR
MB0GA1UdDgQWBBTmW/TdQlcea4S2DtpxVqa6n6jYFTAfBgNVHSMEGDAWgBTmW/Td
Qlcea4S2DtpxVqa6n6jYFTAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUA
A4IBAQBUBWMa50jaKO5GtqdCe2jLhfmEgtc6iLr+XO8jGsK2OzaHTHO9N/mjDOJ0
AAdINbCO2qfYsXBLTgzBLiAsE+IuzfxIiTmzVoLhiV0iWuy1NMXMEy1khAtVjdkx
D1zxCdCw/xe70tmGEfVFGF45OPkdsbDa3fr6tSF2Cl7ZXehdpxuzogWAqV4zqn49
XqLzZvB5gL5LbsbjzoUImce0eIxHgrkxM1RurgyN5EwV+SxkXCGxTmdMHI3Gzebf
t5xM393St030npRIRiAIpiLZUX7Yh7+PU079rE0wHtNvqorW+CrGD92TtYS7IufT
E9PrY2ghO453/QM0jW/E429p/aha
-----END CERTIFICATE-----
subject=CN = crypto200.com

issuer=CN = crypto200.com

---
[REDACTED]
</pre></table></code></div></div><ul><li>Save the certificate to files:</ul><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580530-06b66f6d-ac84-4859-a808-be0d561ec917.png" alt="image" /></p><ul><li>Export public key from the certificate:</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ openssl x509 -pubkey -noout -in cf.pem  &gt; pubkey.pem
</pre></table></code></div></div><p>The public key may look as following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ cat pubkey.pem | xxd -p | tr -d "\\n"
2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b4341514541377035504b46512f7658436c302f656d6a6e5a660a38576555616771636245725255332f4a66773174763575462b6248473461764549584b4e444c35374f2b536d4c516c67436b723841733445306a4133447466780a6337657355534f4247543756556c684e6a4b7446583378516d414d307571744f31316d785764726368616d347631376e59653751414f6b794e506641426879690a34316d51795167503257346b4362767531793963753034776c6754684a7133466b7578745172587461464956425831386f4a724a496b3663562f7139774153620a6c302f5257584672764754495a587a42716638744e4c41517771664d635148434a66772b5a51464d31697373735675594f4f724f566b6b5235427163562f376b0a46426a4d4666316a4e2f396666627237565a454b3476504c6145444d33644e3746696953576362727961634b63504c34763632357765484f662b4d48376859370a52774944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a
</pre></table></code></div></div><h5 id="b-generate-new-token-and-submit-to-get-flag">b) Generate new token and submit to get flag:<a href="#b-generate-new-token-and-submit-to-get-flag"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li>Run TokenBreaker tool to generate new token. Remember to change the value of <code class="language-plaintext highlighter-rouge">username</code> to <code class="language-plaintext highlighter-rouge">admin</code>. The new token is shorter than the origianl one.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>thangpd3160@kali:~$ python3 RsaToHmac.py -t eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJpYXQiOjE2MzQ0ODE0OTIsIm5iZiI6MTYzNDQ4MjQ5MiwiZXhwIjoxNjM0NDg3NDkyLCJkYXRhIjp7ImlkIjoiMTM3IiwidXNlcm5hbWUiOiJ0aGFuZ3BkMTEiLCJlbWFpbCI6InRoYW5ncGQxMUBnbWFpbC5jb20ifX0.n7t8HqHsWYCdR4fk_-VPgRHtJuNKb1DGQPAGWcNrlaxjaRnft8fbPUOLBmgUD1xY6Xp0OL4ov4BuhvbzbOvjrAbzfjXq4MEDiadDxnObQr9c3gPrB82uoY3YyVqtg_TXa8yfz5HMWsMGpKg5QjRNVqWYCqF1-6-LNuLkp54mjPeJctcQHVONCy8tIpCR08E9_G4vpLEEYBPcXPkcD44FH56xnNUlMpDkTayhv5wZ-2nPuFiBsuNP_glp-6abAsDgMSbSHLSQc-mPEecTVx929lNHCjhzFIFqXEFdNNXt3Y3JWdx-VXIIUM2yfxKkubV8NCn8s9nfwXpbIMfIPA9rPQ -p pubkey.pem
 ___  ___   _     _         _  _ __  __   _   ___
| _ \/ __| /_\   | |_ ___  | || |  \/  | /_\ / __|
|   /\__ \/ _ \  |  _/ _ \ | __ | |\/| |/ _ \ (__
|_|_\|___/_/ \_\  \__\___/ |_||_|_|  |_/_/ \_\___|

[*] Decoded Header value: {"typ":"JWT","alg":"RS256"}
[*] Decode Payload value: {"iat":1634481492,"nbf":1634482492,"exp":1634487492,"data":{"id":"137","username":"thangpd11","email":"thangpd11@gmail.com"}}
[*] New header value with HMAC: {"typ":"JWT","alg":"HS256"}
[&lt;] Modify Header? [y/N]: 
[&lt;] Enter Your Payload value: {"iat":1634481492,"nbf":1634482492,"exp":1634487492,"data":{"id":"137","username":"admin","email":"thangpd11@gmail.com"}}
[+] Successfully Encoded Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2MzQ0ODE0OTIsIm5iZiI6MTYzNDQ4MjQ5MiwiZXhwIjoxNjM0NDg3NDkyLCJkYXRhIjp7ImlkIjoiMTM3IiwidXNlcm5hbWUiOiJhZG1pbiIsImVtYWlsIjoidGhhbmdwZDExQGdtYWlsLmNvbSJ9fQ.HuhcSbgVOFqbUGfY9KQ2g4thh_v4TuQioNujlMiXNOY
</pre></table></code></div></div><ul><li>Replace token value in burp request, then submit to get the flag:</ul><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138580616-a85f5afb-cedd-45b1-b186-80bae5bdd9f1.png" alt="image" /></p><h1 id="noone">NoOne</h1><p>This is the last challenge, but actually the easiest challenge ever. The idea of this challenge is just fipping one bit, so that is the role from user (1) to admin (0), then we got the flag. Full source code can be found at <a href="https://github.com/FPTU-Ethical-Hackers-Club/SVATTT/blob/main/2021/crypto/NoOne/src.py">here</a>.</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138581209-43c080c7-0e19-4143-97bd-1c37ea92d392.png" alt="image" /></p><h3 id="1-challenge-analysis-2">1. Challenge analysis:<a href="#1-challenge-analysis-2"><i class="fas fa-hashtag"></i></a></h3></h3><p>This challenge is same as the EasyOne challenge, we also need to login as admin, but can by normal register. The different is there is no <code class="language-plaintext highlighter-rouge">/logincert</code> anymore.</p><p>Follow the code, the <code class="language-plaintext highlighter-rouge">login_required</code> function tell us that it extract the user role from the <code class="language-plaintext highlighter-rouge">authtoken</code> value in cookies:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">login_required</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="o">@</span><span class="n">wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>
        
            <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'authtoken'</span><span class="p">)</span>

            <span class="n">userid</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'userid'</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">ciphertext</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">userid</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">'login'</span><span class="p">))</span>

            <span class="n">encryptkey</span> <span class="o">=</span> <span class="n">get_encryptkey</span><span class="p">(</span><span class="n">userid</span><span class="p">)</span>

            <span class="n">plainbytes</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">encryptkey</span><span class="p">)</span>

            <span class="n">usernamelen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">plainbytes</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="s">"little"</span><span class="p">)</span>
            <span class="n">usernameencoded</span> <span class="o">=</span> <span class="n">plainbytes</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">usernamelen</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">username</span> <span class="o">=</span> <span class="n">usernameencoded</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">)</span>
            <span class="n">role</span> <span class="o">=</span> <span class="n">plainbytes</span><span class="p">[</span><span class="n">usernamelen</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            
            <span class="n">g</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
            <span class="n">g</span><span class="p">.</span><span class="n">role</span> <span class="o">=</span> <span class="n">role</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">abort</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
   
    <span class="k">return</span> <span class="n">wrap</span>
</pre></table></code></div></div><p>Follow the code, I see that the <code class="language-plaintext highlighter-rouge">authtokenvalue</code> is encrypted using AES in CFB mode:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">plainbytes</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    
    <span class="n">iv</span> <span class="o">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">new</span><span class="p">().</span><span class="n">read</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">)</span>
    
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CFB</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
    
    <span class="n">cipherbytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plainbytes</span><span class="p">)</span>

    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="n">cipherbytes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ciphertext</span>
</pre></table></code></div></div><p>And the value of <code class="language-plaintext highlighter-rouge">authtoken</code> is generated after we logon. I registered with username <em>thangpd11</em>, so that the role bytes value will lie in the first block.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">(</span><span class="s">'GET'</span><span class="p">,</span> <span class="s">'POST'</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">'POST'</span><span class="p">:</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">'password'</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
            <span class="n">flash</span><span class="p">(</span><span class="s">'Username and Password is required!'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># verify login
</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">verify_login</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
                <span class="n">flash</span><span class="p">(</span><span class="s">'Username and Password is not correct!'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                
                <span class="n">userid</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">username</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">role</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

                <span class="c1"># get key
</span>                <span class="n">key</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

                <span class="c1"># create authtoken
</span>                <span class="n">usernamebytes</span> <span class="o">=</span> <span class="n">username</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
                <span class="n">usernamelen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">usernamebytes</span><span class="p">)</span>
                <span class="n">plainbytes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">usernamebytes</span><span class="p">).</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"little"</span><span class="p">)</span> <span class="o">+</span> <span class="n">usernamebytes</span> <span class="o">+</span> <span class="n">role</span><span class="p">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"little"</span><span class="p">)</span>

                <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">plainbytes</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

                <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s">'index'</span><span class="p">)))</span>

                <span class="n">response</span><span class="p">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s">'userid'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">userid</span><span class="p">))</span>
                <span class="n">response</span><span class="p">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s">'authtoken'</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">response</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'login.html'</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="2-bit-flipping-attack-on-aes-cfb">2. Bit Flipping Attack on AES CFB<a href="#2-bit-flipping-attack-on-aes-cfb"><i class="fas fa-hashtag"></i></a></h3></h3><p>I take the folllowing from gooogle to help me easily illustrate the attack. The concept is actually very similar to the bit flipping attack on AES CBC (the classic one).</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138589425-afa13bee-7a06-4a49-a116-e73802396f8b.png" alt="image" /></p><p>The decryption process of the first block can be interpreted in mathematic formula as <strong>P₁ = E(IV) ⊕ C₁ or E(IV) = P₁ ⊕ C₁</strong>.</p><p>The point is we wanna change <strong>P₁</strong> to <strong>P₁’</strong>. Simply, we just need to change the <strong>C₁</strong> value to another <strong>C₁’</strong> value, such that <strong>E(IV)</strong> value remains. In mathematical formula, we can interpret the above words as:</p><p><strong>E(IV) = P₁ ⊕ C₁ = P₁’ ⊕ C₁’</strong></p><p>or</p><p><strong>P₁ ⊕ C₁ = P₁’ ⊕ C₁’</strong></p><h4 id="3-exploit-and-get-the-flag">3. Exploit and get the flag<a href="#3-exploit-and-get-the-flag"><i class="fas fa-hashtag"></i></a></h4></h4><p>With that in mind, now I code the exploit tool as follow. As I’m so lazy, I don’t code the full exploit, so I change the cookies value manually through Burp Suite:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">Crypto</span> <span class="kn">import</span> <span class="n">Random</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span><span class="p">,</span> <span class="n">b64encode</span>

<span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">_a</span> <span class="o">^</span> <span class="n">_b</span> <span class="k">for</span> <span class="n">_a</span><span class="p">,</span> <span class="n">_b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)])</span>

<span class="n">iv</span> <span class="o">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">new</span><span class="p">().</span><span class="n">read</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">Random</span><span class="p">.</span><span class="n">new</span><span class="p">().</span><span class="n">read</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">)</span>

<span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CFB</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>

<span class="n">username</span> <span class="o">=</span> <span class="s">'thangpd11'</span>
<span class="n">role</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">usernamebytes</span> <span class="o">=</span> <span class="n">username</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="n">usernamelen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">usernamebytes</span><span class="p">)</span>
<span class="n">plainbytes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">usernamebytes</span><span class="p">).</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"little"</span><span class="p">)</span> <span class="o">+</span> <span class="n">usernamebytes</span> <span class="o">+</span> <span class="n">role</span><span class="p">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"little"</span><span class="p">)</span>

<span class="n">cipherbytes</span> <span class="o">=</span> <span class="n">b64decode</span><span class="p">(</span><span class="sa">b</span><span class="s">'tzRxbyN82l8uJK06ZdSQSI+kc1x1vnjPTLXL6w=='</span><span class="p">)</span> <span class="c1">#authtoken in cookies value
</span><span class="n">iv</span> <span class="o">=</span> <span class="n">cipherbytes</span><span class="p">[:</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">]</span>
<span class="n">cipherbytes</span> <span class="o">=</span> <span class="n">cipherbytes</span><span class="p">[</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">:]</span>

<span class="n">new_role</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plainbytes_new</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">usernamebytes</span><span class="p">).</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"little"</span><span class="p">)</span> <span class="o">+</span> <span class="n">usernamebytes</span> <span class="o">+</span> <span class="n">new_role</span><span class="p">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"little"</span><span class="p">)</span>

<span class="n">cipherbytes_new</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">xor</span><span class="p">(</span><span class="n">plainbytes_new</span><span class="p">,</span> <span class="n">plainbytes</span><span class="p">),</span> <span class="n">cipherbytes</span><span class="p">)</span>

<span class="n">ciphertext_new</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="n">cipherbytes_new</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ciphertext_new</span><span class="p">)</span>
</pre></table></code></div></div><p>The new authtoken is <strong>tzRxbyN82l8uJK06ZdSQSI+kc1x1vnjPTLXL6g==</strong>. Let’s submit it and get flag.</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/61876488/138590429-e19a91c7-2284-45d6-9621-d56a017b9022.png" alt="image" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/cryptographic-challenges/'>Cryptographic Challenges</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/cryptographic/" class="post-tag no-text-decoration" >cryptographic</a> <a href="/tags/svattt2021/" class="post-tag no-text-decoration" >SVATTT2021</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups - Ethical Hackers Club&url=https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups - Ethical Hackers Club&u=https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups - Ethical Hackers Club&url=https://fptu-ethical-hackers-club.github.io/posts/SVATTT-Crypto/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h4>Recent Update</h4><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SVATTT-Crypto/">ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups</a><li><a href="/posts/SVATTT-Web/">ASCIS (ASEAN Student Contest on Information Security) 's Web Write-ups</a><li><a href="/posts/FuSec3-Forensics/">FPTU SecAthon 2020 | Forensics Writeup | FRS301</a><li><a href="/posts/ACSC2021-Forensics/">Asian Cyber Security Challenge 2021 | Forensics Writeup | Nyong Coin, BitLocker Artifact</a><li><a href="/posts/FuSec4-CRY302-CRY303/">FPTU SecAthon 2021 | Cryptographic Writeup | CRY302 & CRY303</a></ul></div><div id="access-tags"><h4 class="text-muted">Trending Tags</h4><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/wiki/">wiki</a> <a class="post-tag" href="/tags/fusec21/">fusec21</a> <a class="post-tag" href="/tags/cryptographic/">cryptographic</a> <a class="post-tag" href="/tags/fusec20/">fusec20</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/acsc21/">acsc21</a> <a class="post-tag" href="/tags/svattt2021/">SVATTT2021</a> <a class="post-tag" href="/tags/binary/">binary</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h4 class="pl-3 pt-2 mb-2">Contents</h4><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FuSec4-CRY301/"><div class="card-body"> <em class="timeago small" date="2021-10-10 10:00:00 +0700" >Oct 10</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Cryptographic Writeup | CRY301</h3><div class="text-muted small"><p> CRY301 Source code and analysis Một bài crypto giải bằng kiến thức toán học và tư duy về code. Full source code đề bài xem tại đây Bài này yêu cầu mình tìm được số x ban đầu từ kết quả của 2 hàm...</p></div></div></a></div><div class="card"> <a href="/posts/FuSec4-CRY302-CRY303/"><div class="card-body"> <em class="timeago small" date="2021-10-10 11:00:00 +0700" >Oct 10</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Cryptographic Writeup | CRY302 & CRY303</h3><div class="text-muted small"><p> CRY302 Một bài liên quan tới hash, cách thực hiện khá dễ. Full source code bạn có thể xem tại đây Bổ đề Tóm tắt lại thì mình sẽ được đưa cho 1 số tiền ngẫu nhiên từ 1 tới 2000 và bị bắt phải m...</p></div></div></a></div><div class="card"> <a href="/posts/FuSec3-CRY301-CRY302/"><div class="card-body"> <em class="timeago small" date="2020-10-21 15:34:00 +0700" >Oct 21, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2020 | Cryptographic Writeup | CRY301 & CRY302</h3><div class="text-muted small"><p> This is an annual competition for FPT University students to practice their skills with jeopardy CTF challenges. I was with my team, M1sh13f, and we’re at the #5 place. Congrats me and my amaz...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/FuSec4-PRP202/" class="btn btn-outline-primary" prompt="Older"><p>FPTU SecAthon 2021 | Web Writeup | PRP202</p></a> <a href="/posts/SVATTT-Web/" class="btn btn-outline-primary" prompt="Newer"><p>ASCIS (ASEAN Student Contest on Information Security) 's Web Write-ups</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/FPTU-Ethical-Hackers-Club">FPTU Ethical Hackers' Club</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><h4 class="text-muted">Trending Tags</h4><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/wiki/">wiki</a> <a class="post-tag" href="/tags/fusec21/">fusec21</a> <a class="post-tag" href="/tags/cryptographic/">cryptographic</a> <a class="post-tag" href="/tags/fusec20/">fusec20</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/acsc21/">acsc21</a> <a class="post-tag" href="/tags/svattt2021/">SVATTT2021</a> <a class="post-tag" href="/tags/binary/">binary</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
